WITH a
AS
  (
  SELECT FLAVOR, SUM(TOTAL_ORDER) AS TOTAL_ORDER
  FROM JULY
  GROUP BY 1
  ORDER BY 2 DESC
  )
,

b
AS
  (
  SELECT a.FLAVOR, SUM(a.TOTAL_ORDER+b.TOTAL_ORDER) AS TOTAL_ORDER
  FROM FIRST_HALF b
  JOIN a
  ON b.FLAVOR = a.FLAVOR
  GROUP BY 1
  ORDER BY 2 DESC
  LIMIT 3
  )

SELECT FLAVOR
FROM b
